<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Depósitos - Geramaster App</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body>
    <div class="container my-4">
        <h2 class="text-center mb-4">Geramaster App</h2>
        <h1 class="mb-4">Registro de Depósitos</h1>

        <a href="{{ url_for('logout') }}" class="btn btn-danger mb-3">Sair</a><br>
        <a href="{{ url_for('menu') }}" class="btn btn-secondary mb-4">Voltar para Menu</a>

        <!-- Formulário para inserir depósito -->
        <form method="POST" class="mb-5">
            <div class="mb-3">
                <label for="usuario" class="form-label">Técnico</label>
                <select name="usuario" id="usuario" class="form-select" required>
                    <option value="">Selecione um técnico</option>
                    {% for tecnico in tecnicos %}
                        <option value="{{ tecnico }}">{{ tecnico }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="mb-3">
                <label for="valor" class="form-label">Valor</label>
                <input type="number" step="0.01" name="valor" id="valor" class="form-control" required />
            </div>

            <div class="mb-3">
                <label for="data" class="form-label">Data</label>
                <input type="date" name="data" id="data" class="form-control" required />
            </div>

            <button type="submit" class="btn btn-primary">Registrar Depósito</button>
        </form>

        <!-- Histórico de depósitos -->
        <!-- Histórico de depósitos -->
<h3>Histórico de Depósitos</h3>
{% if depositos %}
<table class="table table-striped table-bordered align-middle">
    <thead>
        <tr>
            <th>Técnico</th>
            <th>Valor (R$)</th>
            <th>Data</th>
            <th>Ação</th>  <!-- Nova coluna -->
        </tr>
    </thead>
    <tbody>
        {% for id, valor, data, usuario in depositos %}
        <tr>
            <td>{{ usuario }}</td>
            <td>{{ '%.2f'|format(valor) }}</td>
            <td>{{ data }}</td>
            <td>
                <form method="POST" action="{{ url_for('deletar_deposito', deposito_id=id) }}" onsubmit="return confirm('Confirma exclusão deste depósito?');">
                    <button type="submit" class="btn btn-sm btn-danger">Excluir</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<p>Nenhum depósito registrado ainda.</p>
{% endif %}

    </div>
</body>
</html>
